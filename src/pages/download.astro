---
import Layout from '../layouts/Layout.astro';
import Header from '../components/layout/Header.astro';
import Footer from '../components/layout/Footer.astro';
import Sidebar from '../layouts/Sidebar.astro';
import CTA from '../sections/CTA.astro';

const downloads = {
  linuxDeb: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/gitset-desktop_1.6.0_amd64-G4ehTu1mn4wY7MvczYoVECDHwqB7S9.deb',
  linuxAppImage: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/Gitset-1.6.0-KZSLVgEAeHK8Ul0BVH2x22MwYL08oB.AppImage',
  macOS: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/Gitset-1.6.0-JZ07qncwnQXae2Pjq7iBTXqxgzJ5iy.dmg',
  windows: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/Gitset%20Setup%201.6.0-QpeEjb5VQzpIHXjJkEgomsTUhUrpP4.exe'
};
---
<Layout title="Gitset - Gitset - Download Desktop Application.">
  <Sidebar />
  <div class="flex flex-col min-h-screen">
    <div class="hidden lg:block fixed w-64 h-full">
      <Sidebar />
    </div>
    
    <div class="flex-1 lg:ml-64 flex flex-col">
      <Header />
      <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 mt-16  top">
          <br />
          <div class="flex justify-center"></div>
          <CTA
            align="center"
            title={`<span id="cta-title"><strong>Gitset</strong> Desktop</span>`}
            description={`
              <span id="cta-description">
                Download <span class="font-semibold">Gitset Desktop App</span> for your OS and simplify Git management with AI-powered tools.
              </span>
            `}
          >
        <div class="w-full px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
          
          <!-- Main Download Card -->
          <div class="flex justify-center mb-8 sm:mb-12 lg:mb-16">
            <div class="main-download-card w-full max-w-lg rounded-2xl shadow-xl border border-[#5bc4b8] dark:border-gray-700 p-6 sm:p-8">
              <div class="flex flex-col items-center text-center space-y-4 sm:space-y-6">
                <div id="os-icon" class="flex items-center justify-center"></div>
                <h2 id="detected-os" class="text-xl sm:text-2xl lg:text-3xl font-bold text-neutral-700"></h2>
                <div id="os-specification" class="flex items-center justify-center"></div>
                <a id="download-btn" href="#" class="w-full max-w-xs bg-neutral-700 border-1 border-[#5bc4b8] text-[#a2a2a2] hover:text-[#5bc4b8] font-semibold py-3 sm:py-4 px-6 sm:px-8 rounded-xl transition-all duration-200 flex items-center justify-center space-x-2 transform hover:scale-105">
                  <svg class="w-4 h-4 sm:w-5 sm:h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor-down-icon lucide-monitor-down"><path d="M12 13V7"/><path d="m15 10-3 3-3-3"/><rect width="20" height="14" x="2" y="3" rx="2"/><path d="M12 17v4"/><path d="M8 21h8"/></svg>
                  <span class="text-sm sm:text-base">Download for <span id="os-name-btn"></span></span>
                </a>
              </div>
            </div>
          </div>

          <!-- Other Platforms -->
          <div class="flex flex-col items-center mb-8 sm:mb-12 lg:mb-16">
            <h3 class="text-lg sm:text-xl lg:text-2xl font-bold text-neutral-700 text-center mb-6 sm:mb-8">Other Platforms</h3>
            <div id="other-options" class="w-full max-w-4xl grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-4 sm:gap-6"></div>
          </div>

          <!-- Features Grid -->
          <div class="flex justify-center mb-8 sm:mb-12 lg:mb-16">
            <div class="features-card w-full max-w-5xl rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6 sm:p-8">
              <h3 class="text-lg sm:text-xl lg:text-2xl font-bold text-neutral-700 my-0 mx-auto text-center mb-6 sm:mb-8">Why Choose Gitset Desktop?</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8">
                
                <div class="flex flex-col items-center text-center space-y-3 sm:space-y-4">
                  <div class="w-12 h-12 sm:w-16 sm:h-16 border-2 hover:border-[#5bc4b8] hover:text-[#5bc4b8] rounded-2xl flex items-center justify-center transform hover:scale-110 transition-transform duration-200">
                    <svg class="w-6 h-6 sm:w-8 sm:h-8 text-[#a2a2a2] " fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                  </div>
                  <h4 class="text-base sm:text-lg font-semibold text-neutral-700">AI-Powered Tools</h4>
                  <p class="text-neutral-700 text-sm leading-relaxed">
                    Intelligent assistance for README generation, .gitignore creation, commit messages, versioning, and dependency management.
                  </p>
                </div>

                <div class="flex flex-col items-center text-center space-y-3 sm:space-y-4">
                  <div class="w-12 h-12 sm:w-16 sm:h-16 border-2 hover:border-[#5bc4b8] hover:text-[#5bc4b8] rounded-2xl flex items-center justify-center transform hover:scale-110 transition-transform duration-200">
                    <svg class="w-6 h-6 sm:w-8 sm:h-8 text-[#a2a2a2] " fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                    </svg>
                  </div>
                  <h4 class="text-base sm:text-lg font-semibold text-neutral-700">Seamless Integration</h4>
                  <p class="text-neutral-700 text-sm leading-relaxed">
                    Direct integration with GitHub and Git repositories for a smooth and efficient development workflow.
                  </p>
                </div>

                <div class="flex flex-col items-center text-center space-y-3 sm:space-y-4">
                  <div class="w-12 h-12 sm:w-16 sm:h-16 border-2 hover:border-[#5bc4b8] hover:text-[#5bc4b8] rounded-2xl flex items-center justify-center transform hover:scale-110 transition-transform duration-200">
                    <svg class="w-6 h-6 sm:w-8 sm:h-8 text-[#a2a2a2] " fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                  </div>
                  <h4 class="text-base sm:text-lg font-semibold text-neutral-700">Cross-Platform</h4>
                  <p class="text-neutral-700 text-sm leading-relaxed">
                    Consistent experience across Windows, macOS, and Linux with identical powerful features on every platform.
                  </p>
                </div>
              
              </div>
                  <!-- Back Button -->
                <div class="flex mx-auto pt-4 my-0 justify-center text-center">
                    <a href="/" class="bg-neutral-700 items-center px-4 sm:px-6 py-2 sm:py-3 text-[#a2a2a2] hover:border-[#5bc4b8] hover:text-[#5bc4b8] font-medium rounded-lg transition-all duration-200">
                      <span class="text-sm sm:text-base">Back to Home</span>
                    </a>
                </div>
            </div>
          </div>
          </CTA>
        </div>
      </main>
      <Footer />
    </div>
  </div>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    detectOS();
    setupLinuxDropdowns();
    setTimeout(applyDownloadButtonStyles, 100);
    window.addEventListener('resize', equalizeCardHeights);
    equalizeCardHeights();
  });

  function equalizeCardHeights() {
    const cards = document.querySelectorAll('#other-options > div') as NodeListOf<HTMLElement>;
    if (window.innerWidth >= 640) {
      let maxHeight = 0;
      cards.forEach(card => {
        card.style.height = 'auto';
        maxHeight = Math.max(maxHeight, card.offsetHeight);
      });
      cards.forEach(card => {
        card.style.height = `${maxHeight}px`;
      });
    } else {
      cards.forEach(card => {
        card.style.height = 'auto';
      });
    }
  }

  function applyDownloadButtonStyles() {
    document.querySelectorAll('a, button').forEach(element => {
      if (element && element.textContent && element.textContent.trim().includes('Download')) {
        if (!element.id || element.id !== 'download-btn') {
          element.className = "w-full bg-neutral-700 border-1 border-[#5bc4b8] text-[#a2a2a2] hover:text-[#5bc4b8] font-semibold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center space-x-2 text-sm sm:text-base";
        }
      }
    });
  }

  function detectOS() {
    const platform = navigator.platform ? navigator.platform.toLowerCase() : '';
    const userAgent = navigator.userAgent ? navigator.userAgent.toLowerCase() : '';
    const downloads = {
      linuxDeb: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/gitset-desktop_1.6.0_amd64-G4ehTu1mn4wY7MvczYoVECDHwqB7S9.deb',
      linuxAppImage: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/Gitset-1.6.0-KZSLVgEAeHK8Ul0BVH2x22MwYL08oB.AppImage',
      macOS: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/Gitset-1.6.0-JZ07qncwnQXae2Pjq7iBTXqxgzJ5iy.dmg',
      windows: 'https://gc9b7beeqzhshpnd.public.blob.vercel-storage.com/Gitset%20Setup%201.6.0-QpeEjb5VQzpIHXjJkEgomsTUhUrpP4.exe'
    };

    let os = '';
    let downloadLink = '';
    let iconHTML = '';
    let osSpecification = '';
    let otherOptions = [];
    
    if (platform.includes('win') || userAgent.includes('windows')) {
      os = 'Windows';
      downloadLink = downloads.windows;
      iconHTML = `<img src="/os-windows-256.png" alt="Windows" class="h-16 w-16 sm:h-20 sm:w-20 object-contain mx-auto" />`;
      osSpecification = `
        <div class="px-3 sm:px-4 py-1 sm:py-2 rounded-lg">
          <span class="text-xs sm:text-sm font-medium text-neutral-700">Windows 10 or higher</span>
        </div>
      `;
      otherOptions = [
        { 
          name: 'macOS',
          link: downloads.macOS, 
          icon: `<img src="/mac-os-256.png" alt="macOS" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          specification: "macOS 10.13 or higher"
        },
        { 
          name: 'Linux',
          isLinux: true,
          icon: `<img src="/linux-256.png" alt="Linux" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          options: [
            { name: 'Debian (.deb)', link: downloads.linuxDeb },
            { name: 'AppImage (.AppImage)', link: downloads.linuxAppImage }
          ]
        }
      ];
    } else if (platform.includes('mac') || userAgent.includes('macintosh')) {
      os = 'macOS';
      downloadLink = downloads.macOS;
      iconHTML = `<img src="/mac-os-256.png" alt="macOS" class="h-16 w-16 sm:h-20 sm:w-20 object-contain mx-auto" />`;
      osSpecification = `
        <div class="px-3 sm:px-4 py-1 sm:py-2 rounded-lg">
          <span class="text-xs sm:text-sm font-medium text-neutral-700">macOS 10.13 or higher</span>
        </div>
      `;
      otherOptions = [
        { 
          name: 'Windows',
          link: downloads.windows, 
          icon: `<img src="/os-windows-256.png" alt="Windows" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          specification: "Windows 10 or higher"
        },
        { 
          name: 'Linux',
          isLinux: true,
          icon: `<img src="/linux-256.png" alt="Linux" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          options: [
            { name: 'Debian (.deb)', link: downloads.linuxDeb },
            { name: 'AppImage (.AppImage)', link: downloads.linuxAppImage }
          ]
        }
      ];
    } else if (platform.includes('linux') || userAgent.includes('linux')) {
      os = 'Linux';
      downloadLink = downloads.linuxAppImage; 
      iconHTML = `<img src="/linux-256.png" alt="Linux" class="h-16 w-16 sm:h-20 sm:w-20 object-contain mx-auto" />`;
      osSpecification = `
        <div class="w-full max-w-xs">
          <div class="relative">
            <select id="linux-format-main" class="w-full bg-gray-100 dark:bg-gray-700 px-3 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-medium text-neutral-700 border-none focus:outline-none cursor-pointer appearance-none pr-8">
              <option value="${downloads.linuxAppImage}" selected>AppImage (.AppImage)</option>
              <option value="${downloads.linuxDeb}">Debian (.deb)</option>
            </select>
            <div class="absolute right-2 top-2 sm:top-3 pointer-events-none">
              <svg class="w-3 h-3 sm:w-4 sm:h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </div>
          </div>
        </div>
      `; 
      otherOptions = [
        { 
          name: 'Windows',
          link: downloads.windows, 
          icon: `<img src="/os-windows-256.png" alt="Windows" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          specification: "Windows 10 or higher"
        },
        { 
          name: 'macOS',
          link: downloads.macOS, 
          icon: `<img src="/mac-os-256.png" alt="macOS" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          specification: "macOS 10.13 or higher"
        }
      ];
    } else {
      os = 'Unknown OS';
      downloadLink = '#';
      iconHTML = `<div class="w-16 h-16 sm:w-20 sm:h-20 bg-gray-200 dark:bg-gray-700 rounded-2xl flex items-center justify-center mx-auto">
        <svg class="w-8 h-8 sm:w-10 sm:h-10 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
        </svg>
      </div>`;
      osSpecification = `
        <div class="bg-gray-100 dark:bg-gray-700 px-3 sm:px-4 py-1 sm:py-2 rounded-lg">
          <span class="text-xs sm:text-sm font-medium text-neutral-700">Choose your platform below</span>
        </div>
      `;
      otherOptions = [
        { 
          name: 'Windows',
          link: downloads.windows, 
          icon: `<img src="/os-windows-256.png" alt="Windows" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          specification: "Windows 10 or higher"
        },
        { 
          name: 'macOS',
          link: downloads.macOS, 
          icon: `<img src="/mac-os-256.png" alt="macOS" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          specification: "macOS 10.13 or higher"
        },
        { 
          name: 'Linux',
          isLinux: true,
          icon: `<img src="/linux-256.png" alt="Linux" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto" />`,
          options: [
            { name: 'Debian (.deb)', link: downloads.linuxDeb },
            { name: 'AppImage (.AppImage)', link: downloads.linuxAppImage }
          ]
        }
      ];
    }

    const detectedOsElement = document.getElementById('detected-os') as HTMLElement;
    const osIconElement = document.getElementById('os-icon') as HTMLElement;
    const osSpecificationElement = document.getElementById('os-specification') as HTMLElement;
    const downloadBtn = document.getElementById('download-btn') as HTMLAnchorElement;
    const osNameBtn = document.getElementById('os-name-btn') as HTMLElement;
    const otherOptionsContainer = document.getElementById('other-options') as HTMLElement;

    if (detectedOsElement) {
      detectedOsElement.textContent = os;
    }
    
    if (osNameBtn) {
      osNameBtn.textContent = os;
    }
    
    if (osIconElement) {
      osIconElement.innerHTML = iconHTML;
    }
    
    if (osSpecificationElement) {
      osSpecificationElement.innerHTML = osSpecification;
    }
    
    if (downloadBtn) {
      downloadBtn.setAttribute('href', downloadLink);
    }

    if (otherOptionsContainer) {
      otherOptionsContainer.innerHTML = otherOptions.map(opt => {
      if (opt.isLinux) {
        return `
          <div class="other-platform-card rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-4 sm:p-6 hover:shadow-xl transition-all duration-200">
            <div class="flex flex-col items-center text-center space-y-3 sm:space-y-4 h-full">
              <div class="flex items-center justify-center">
                ${opt.icon}
              </div>
              <h4 class="text-base sm:text-lg font-semibold text-neutral-700">${opt.name}</h4>
              <div class="flex-grow flex items-center justify-center w-full">
                <div class="w-full max-w-xs">
                  <div class="relative">
                    <select class="linux-format-select text-center w-full px-3 py-2 rounded-lg text-sm text-neutral-700 border-none focus:outline-none cursor-pointer appearance-none pr-8">
                      <option value="${opt.options[0].link}" selected>${opt.options[0].name}</option>
                      <option value="${opt.options[1].link}">${opt.options[1].name}</option>
                    </select>
                    <div class="absolute right-2 top-3 pointer-events-none">
                      <svg class="w-4 h-4 text-neutral-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
              <a href="${opt.options[0].link}" class="linux-download-link w-full bg-neutral-700 border-1 border-[#5bc4b8] text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center space-x-2">
                <svg class="w-4 h-4 sm:w-5 sm:h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor-down-icon lucide-monitor-down"><path d="M12 13V7"/><path d="m15 10-3 3-3-3"/><rect width="20" height="14" x="2" y="3" rx="2"/><path d="M12 17v4"/><path d="M8 21h8"/></svg>
                <span>Download</span>
              </a>
            </div>
          </div>
        `;
      } else {
        return `
          <div class="other-platform-card rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-4 sm:p-6 hover:shadow-xl transition-all duration-200">
            <div class="flex flex-col items-center text-center space-y-3 sm:space-y-4 h-full">
              <div class="flex items-center justify-center">
                ${opt.icon}
              </div>
              <h4 class="text-base sm:text-lg font-semibold text-neutral-700">${opt.name}</h4>
              <div class="flex-grow flex items-center justify-center">
                <div class="px-3 py-1 rounded-lg">
                  <span class="text-xs sm:text-sm text-neutral-700">${opt.specification}</span>
                </div>
              </div>
              <a href="${opt.link}" class="w-full bg-neutral-700 border-1 border-[#5bc4b8] text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center space-x-2">
                <svg class="w-4 h-4 sm:w-5 sm:h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor-down-icon lucide-monitor-down"><path d="M12 13V7"/><path d="m15 10-3 3-3-3"/><rect width="20" height="14" x="2" y="3" rx="2"/><path d="M12 17v4"/><path d="M8 21h8"/></svg>
                <span>Download</span>
              </a>
            </div>
          </div>
        `;
      }
          }).join('');
    }

    const linuxFormatSelect = document.getElementById('linux-format-main') as HTMLSelectElement;
    if (linuxFormatSelect) {
      linuxFormatSelect.addEventListener('change', (e) => {
        const target = e.target as HTMLSelectElement;
        const downloadBtn = document.getElementById('download-btn');
        if (target && downloadBtn) {
          downloadBtn.setAttribute('href', target.value);
        }
      });
    }
    
    setTimeout(() => {
      applyDownloadButtonStyles();
      equalizeCardHeights();
    }, 10);
  }

  function setupLinuxDropdowns() {
    const linuxSelects = document.querySelectorAll('.linux-format-select') as NodeListOf<HTMLSelectElement>;
    linuxSelects.forEach(select => {
      select.addEventListener('change', (e) => {
        const target = e.target as HTMLSelectElement;
        const card = target.closest('div');
        const downloadLink = card?.querySelector('.linux-download-link') as HTMLAnchorElement;
        if (downloadLink) {
          downloadLink.setAttribute('href', target.value);
        }
      });
    });
  }
</script>

<style>
  select {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
  }
  
  select::-ms-expand {
    display: none;
  }


  .dark .main-download-card,
  html.dark .main-download-card,
  body.dark .main-download-card,
  [data-theme="dark"] .main-download-card {
    background-color: #2d2d2d !important;
  }

  .dark .features-card,
  html.dark .features-card,
  body.dark .features-card,
  [data-theme="dark"] .features-card {
    background-color: #2d2d2d !important;
  }

  .other-platform-card {
    background-color: white !important;
  }

  .dark .other-platform-card,
  html.dark .other-platform-card,
  body.dark .other-platform-card,
  [data-theme="dark"] .other-platform-card {
    background-color: #2d2d2d !important;
  }
</style>